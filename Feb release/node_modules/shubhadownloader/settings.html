<html>
<head>
    <title>Accordion Layout</title>
    <!-- Ext -->
    <script src="jquery-latest.min.js" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="resources/css/ext-all.css" />

    <!-- GC -->

    <style type="text/css">
        html, body {
            font: normal 12px verdana;
            margin: 0;
            padding: 0;
            border: 0 none;
            overflow: hidden;
            height: 100%;
        }
        .empty .x-panel-body {
            padding-top:20px;
            text-align:center;
            font-style:italic;
            color: gray;
            font-size:11px;
        }
    </style>
<script type="text/javascript" src="ext-all.js"></script>
<script type="text/javascript" src="save_settings.js"></script>
<script type="text/javascript">
    Ext.require(['*']);

    Ext.onReady(function(){
var nsecm=false,nsefo=false,nseop=false,nseff=false,path='',options='',format='',event='',yahooe=false,yahooie=false,yahoo1=false,yahoo5=false,googlee=false,google1m=false,google5m=false,days=1,yahooreal=false,stdcsv=false,ninja=false,amibrocker=false,advancedget=false,fchart=false,metastock=false,boardmeetings=false,corporateevents=false,deleteallevents=false,amibroker=false;
    var nsecmbndrpt=false,nserpt=false,nseex=false,mcxin=false,mcxcf=false,yahoof=false,ncdex=false,bsecm=false,bsein=false,nsein=false,nseetf=false,nsesme=false,nseeo=false,nseef=false,check=false; 
        // sample static data for the store
        var myData = [
            ['3m Co',                               71.72, 0.02,  0.03,  '9/1 12:00am'],
            ['Alcoa Inc',                           29.01, 0.42,  1.47,  '9/1 12:00am'],
            ['Altria Group Inc',                    83.81, 0.28,  0.34,  '9/1 12:00am']
        ];

        /**
         * Custom function used for column renderer
         * @param {Object} val
         */
        function change(val) {
            if (val > 0) {
                return '<span style="color:green;">' + val + '</span>';
            } else if (val < 0) {
                return '<span style="color:red;">' + val + '</span>';
            }
            return val;
        }

        /**
         * Custom function used for column renderer
         * @param {Object} val
         */
        function pctChange(val) {
            if (val > 0) {
                return '<span style="color:green;">' + val + '%</span>';
            } else if (val < 0) {
                return '<span style="color:red;">' + val + '%</span>';
            }
            return val;
        }

        // create the data store
        var store = Ext.create('Ext.data.ArrayStore', {
            fields: [
               {name: 'company'},
               {name: 'price',      type: 'float'},
               {name: 'change',     type: 'float'},
               {name: 'pctChange',  type: 'float'},
               {name: 'lastChange', type: 'date', dateFormat: 'n/j h:ia'}
            ],
            data: myData
        });

        // create the Grid
        var grid = Ext.create('Ext.grid.Panel', {
            hideCollapseTool: true,
            store: store,
            columnLines: true,
            columns: [
                {
                    text     : 'Company',
                    flex     : 1,
                    sortable : false,
                    dataIndex: 'company'
                },
                {
                    text     : 'Price',
                    width    : 75,
                    sortable : true,
                    renderer : 'usMoney',
                    dataIndex: 'price'
                },
                {
                    text     : 'Change',
                    width    : 75,
                    sortable : true,
                    renderer : change,
                    dataIndex: 'change'
                },
                {
                    text     : '% Change',
                    width    : 75,
                    sortable : true,
                    renderer : pctChange,
                    dataIndex: 'pctChange'
                },
                {
                    text     : 'Last Updated',
                    width    : 85,
                    sortable : true,
                    renderer : Ext.util.Format.dateRenderer('m/d/Y'),
                    dataIndex: 'lastChange'
                },
                {
                    xtype: 'actioncolumn',
                    width: 50,
                    items: [{
                        icon   : '../shared/icons/fam/delete.gif',  // Use a URL in the icon config
                        tooltip: 'Sell stock',
                        handler: function(grid, rowIndex, colIndex) {
                            var rec = store.getAt(rowIndex);
                            alert("Sell " + rec.get('company'));
                        }
                    }, {
                        getClass: function(v, meta, rec) {          // Or return a class from a function
                            if (rec.get('change') < 0) {
                                this.items[1].tooltip = 'Hold stock';
                                return 'alert-col';
                            } else {
                                this.items[1].tooltip = 'Buy stock';
                                return 'buy-col';
                            }
                        },
                        handler: function(grid, rowIndex, colIndex) {
                            var rec = store.getAt(rowIndex);
                            alert((rec.get('change') < 0 ? "Hold " : "Buy ") + rec.get('company'));
                        }
                    }]
                }
            ],
            title: 'Array Grid (Click header to collapse)',
            viewConfig: {
                stripeRows: true
            }
        });

        var item1 = grid;

            var item2 = Ext.create('Ext.Panel', {
                title: 'Select Output Folder Path and Output Format',
                items:[
                {
                    // Use the default, automatic layout to distribute the controls evenly
                    // across a single row
                    xtype: 'checkboxgroup',
                    cls: 'x-check-group-alt',
                    width: 688,
                    height: 108,
                    style: 'margin-top:-20px;',
                    columns: 1,
                    items: [
                                       {
                                                xtype: 'textfield',
                                                fieldLabel: '&nbsp;&nbsp;Output folder path',
                                                name: 'path',
                                                width: 450,
                                                style: 'margin-top:5px;',
                                                labelWidth: 120,
                                                id: 'path'
                                            } ,
                                            {
            // Use the default, automatic layout to distribute the controls evenly
            // across a single row
            xtype: 'checkboxgroup',
            cls: 'x-check-group-alt',
            width: 688,
                    
			columns: 4,
            items: [
				{boxLabel: 'STD.CSV', name: 'cb-horiz-9',checked: true,id:'stdcsv',listeners: {change: STD_CSV}},
				{boxLabel: 'AmiBroker', name: 'cb-horiz-10',id:'amibroker',listeners: {change: AmiBroker}},
				{boxLabel: 'Advanced_Get', name: 'cb-horiz-11',id:'advancedget',listeners: {change:Advanced_Get }},
				{boxLabel: 'FChart', name: 'cb-horiz-11',id:'fchart',listeners: {change:FChart }},
				{boxLabel: 'MetaStock', name: 'cb-horiz-11',id:'metastock',listeners: {change:MetaStock}},
				{boxLabel: 'Ninja', name: 'cb-horiz-11',id:'ninja',listeners: {change:Ninja}}

            ]
        }
                    ]
                }
                                     
                ],
                cls:'empty'
            });

            


            var item3 = Ext.create('Ext.Panel', {
                title: 'BSE',
                items:[
                 {
                    // Use the default, automatic layout to distribute the controls evenly
                    // across a single row
                    xtype: 'checkboxgroup',
                    cls: 'x-check-group-alt',
                    width: 688,
                    height: 108,
                    style: 'margin-top:-20px;',
                    columns: 1,
                    items: [
                {
                    // Use the default, automatic layout to distribute the controls evenly
                    // across a single row
                    xtype: 'checkboxgroup',
                    cls: 'x-check-group-alt',
                    
                    width: 688,
                    
                    
                    columns: 4,
                    items: [
                                        {boxLabel: 'BSE Index', name: 'cb-horiz-9',id:'Bse_Index',listeners: {change: Bse_Index}},
                                        {boxLabel: 'BSE Cash Market', name: 'cb-horiz-10',id:'Bse_Cash_Market',listeners: {change: Bse_Cash_Market}},
                                        //{boxLabel: 'NCDEX Futures', name: 'cb-horiz-11',id:'Ncdex_Futures',listeners: {change:Ncdex_Futures }},
                                        {boxLabel: 'BSE Equity Futures', name: 'cb-horiz-50',id:'BSE_Equity_Futures'},
                                        {boxLabel: 'BSE Equity Options', name: 'cb-horiz-51',id:'BSE_Equity_Options'}
                    ]
                }]}
                
                ],
                cls:'empty'
            });

            var item4 = Ext.create('Ext.Panel', {
                title: 'NSE',
                items: [
                 {
                    // Use the default, automatic layout to distribute the controls evenly
                    // across a single row
                    xtype: 'checkboxgroup',
                    cls: 'x-check-group-alt',
                    width: 688,
                    height: 108,
                    style: 'margin-top:-20px;',
                    columns: 1,
                    items:[
                        {
            // Use the default, automatic layout to distribute the controls evenly
            // across a single row
            xtype: 'checkboxgroup',
            cls: 'x-check-group-alt',
            width: 688,
            
            
			columns: 4,
            items: [
					{boxLabel: 'NSE Cash Market', name: 'cb-horiz-1',checked: true,id:'Nse_Cash_Market',listeners: {change: Nse_Cash_Market}},					
					{boxLabel: 'NSE Equity Futures', name: 'cb-horiz-2',id:'Nse_Equity_Futures',listeners: {change: Nse_Equity_Futures}},
					{boxLabel: 'NSE Equity Options', name: 'cb-horiz-3',id:'Nse_Equity_Options',listeners: {change: Nse_Equity_Options}},
                    {boxLabel: 'NSE Forex Futures', name: 'cb-horiz-4',id: 'Nse_Forex_Futures',listeners: {change: Nse_Forex_Futures}},
					{boxLabel: 'NSE Forex Options', name: 'cb-horiz-5',id:'Nse_Forex_Options',listeners: {change: Nse_Forex_Options}},
					{boxLabel: 'NSE SME', name: 'cb-horiz-6',id:'Nse_Sme',listeners: {change: Nse_Sme}},
					{boxLabel: 'NSE ETF', name: 'cb-horiz-7',id:'Nse_Etf',listeners: {change: Nse_Etf}},
					{boxLabel: 'NSE Index', name: 'cb-horiz-8',id:'Nse_Index',listeners: {change: Nse_Index}},
					{boxLabel: 'Reports', name: 'cb-horiz-17',id:'Nse_reports',listeners: {change:Nse_reports}},
					{boxLabel: 'NSE Combined Reports', name: 'cb-horiz-18',id:'Nse_Combined_reports',listeners: {change:Nse_Combined_reports}},
                                        {boxLabel: 'NCDEX Futures', name: 'cb-horiz-11',id:'Ncdex_Futures',listeners: {change:Ncdex_Futures }}

            ]
        }]}
                
                ],
                cls:'empty'
            });

            var item5 = Ext.create('Ext.Panel', {
                title: 'MCX',
                
                items: [
                {
                    // Use the default, automatic layout to distribute the controls evenly
                    // across a single row
                    xtype: 'checkboxgroup',
                    cls: 'x-check-group-alt',
                    width: 688,
                    height: 108,
                    style: 'margin-top:-20px;',
                    columns: 1,
                    items:[
                {
                
            // Use the default, automatic layout to distribute the controls evenly
            // across a single row
            xtype: 'checkboxgroup',
            cls: 'x-check-group-alt',
            width: 688,
            
            
			columns: 4,
            items: [
				{boxLabel: 'MCX Index', name: 'cb-horiz-15',id:'MCX_Index',listeners: {change:MCX_Index}},
				{boxLabel: 'MCX Commodity Futures', name: 'cb-horiz-14',id:'MCX_Commodity_Futures',listeners: {change:MCX_Commodity_Futures }},
				{boxLabel: 'National Spot Exchange', name: 'cb-horiz-15',id:'National_Spot_Exchange',listeners: {change:National_Spot_Exchange}},
				
				{boxLabel: 'MCX-SX Forex Futures', name: 'cb-horiz-52',id:'MCX_SX_Forex_Futures'},
				{boxLabel: 'MCX-SX Forex Options', name: 'cb-horiz-53',id:'MCX_SX_Forex_Options'},
				{boxLabel: 'MCX-SX Equity Indices', name: 'cb-horiz-54',id:'MCX_SX_Equity_Indices'},
				{boxLabel: 'MCX-SX Equity Options', name: 'cb-horiz-55',id:'MCX_SX_Equity_Options'},						
				{boxLabel: 'MCX-SX Equity Futures', name: 'cb-horiz-56',id:'MCX_SX_Equity_Futures'},
				{boxLabel: 'Mutual Funds NAV', name: 'cb-horiz-56',id:'Mutual_Funds_NAV'}
            ]
        }]}  ],
                cls:'empty'
            });
            
             var item6 = Ext.create('Ext.Panel', {
                title: 'Yahoo',
               items: [{
                    // Use the default, automatic layout to distribute the controls evenly
                    // across a single row
                    xtype: 'checkboxgroup',
                    cls: 'x-check-group-alt',
                    width: 688,
                    height: 108,
                    style: 'margin-top:-20px;',
                    columns: 1,
                    items:[{
            // Use the default, automatic layout to distribute the controls evenly
            // across a single row
            xtype: 'checkboxgroup',
            cls: 'x-check-group-alt',
            width: 688,
            
            
			columns: 4,
            items: [
            
                {boxLabel: 'Yahoo Fundamental', name: 'cb-horiz-12',id:'Yahoo_Fundamental',listeners: {change:Yahoo_Fundamental }},
				{boxLabel: 'Yahoo EOD', name: 'cb-horiz-19',id:'Yahoo_EOD',listeners: {change:Yahoo_EOD}},
				{boxLabel: 'Yahoo IEOD 5min', name: 'cb-horiz-20',id:'Yahoo_IEOD_5min',listeners: {change:Yahoo_IEOD_5min}},
				{boxLabel: 'Yahoo IEOD 1min', name: 'cb-horiz-21',id:'Yahoo_IEOD_1min',listeners: {change:Yahoo_IEOD_1min}},
				{boxLabel: 'Yahoo Realtime', name: 'cb-horiz-22',id:'Yahoo_Realtime',listeners: {change:Yahoo_Realtime}}
            ]
        },
		{
            // Use the default, automatic layout to distribute the controls evenly
            // across a single row
            xtype: 'checkboxgroup',
            cls: 'x-check-group-alt',
			fieldLabel: 'Select TimeZone Offset',
                        labelWidth: 140,
                        width: 688,
            
			columns: 4,
            items: [
					{
					xtype: 'combobox',
					name: 'yahoohr',
					billingFieldName: 'yahoohr',
					fieldLabel: 'Hours',
					id: 'yahoohr',
					labelWidth:40,
					width: 120,
					store: ['1','2','3','4','5','6','7','8','9','10','11','12'],
					editable: false,
					forceSelection: true,
					value: '5'
				},	{
					xtype: 'combobox',
					name: 'yahoomin',
					billingFieldName: 'yahoomin',
					fieldLabel: 'Minutes',
					id: 'yahoomin',
					labelWidth:40,
					width: 120,
					store: ['1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60'],
					editable: false,
					forceSelection: true,
					value: '30'
				}
            ]
        }]}
        
		],
                cls:'empty'
            });
            
            
            var item7 = Ext.create('Ext.Panel', {
                title: 'Google',
                items: [{
                    // Use the default, automatic layout to distribute the controls evenly
                    // across a single row
                    xtype: 'checkboxgroup',
                    cls: 'x-check-group-alt',
                    width: 688,
                    height: 108,
                    style: 'margin-top:-20px;',
                    columns: 1,
                    items:[{
            // Use the default, automatic layout to distribute the controls evenly
            // across a single row
            xtype: 'checkboxgroup',
            cls: 'x-check-group-alt',
            width: 688,
            
            
            
            
			columns: 4,
            items: [
                {boxLabel: 'Google EOD', name: 'cb-horiz-19',id:'Google_EOD',listeners: {change:Google_EOD}},
				{boxLabel: 'Google 1min IEOD', name: 'cb-horiz-20',id:'Google_1min_IEOD',listeners: {change:Google_1min_IEOD}},
				{boxLabel: 'Google 5min IEOD', name: 'cb-horiz-21',id:'Google_5min_IEOD',listeners: {change:Google_5min_IEOD}},
            ]
        },
		
		{
            // Use the default, automatic layout to distribute the controls evenly
            // across a single row
            xtype: 'checkboxgroup',
            cls: 'x-check-group-alt',
			fieldLabel: 'Days for google EOD',
                        labelWidth: 117,
                        width: 688,
            
			columns: 4,
            items: [
					{
					xtype: 'combobox',
					name: 'gd',
					billingFieldName: 'gd',
					fieldLabel: '',
					id: 'google',
					labelWidth:70,
					width: 120,
					store: ['1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50'],
					editable: false,
					valueField: 'a',
					displayField: 'a',
					forceSelection: true,
					value: '1'
				}
            ]
        },
		{
            // Use the default, automatic layout to distribute the controls evenly
            // across a single row
            xtype: 'checkboxgroup',
            cls: 'x-check-group-alt',
			fieldLabel: 'Select TimeZone Offset',
                        labelWidth: 140,
                        width: 688,
            
			columns: 4,
            items: [
					{
					xtype: 'combobox',
					name: 'googlehr',
					billingFieldName: 'googlehr',
					fieldLabel: 'Hours',
					id: 'googlehr',
					labelWidth:40,
					width: 120,
					store: ['0','1','2','3','4','5','6','7','8','9','10','11','12'],
					editable: false,
					forceSelection: true,
					value: '5'
				},	{
					xtype: 'combobox',
					name: 'googlemin',
					billingFieldName: 'googlemin',
					fieldLabel: 'Minutes',
					id: 'googlemin',
					labelWidth:40,
					width: 120,
					store: ['0','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60'],
					editable: false,
					forceSelection: true,
					value: '30'
				}
            ]
        }]}],
                cls:'empty'
            });
            
            
            var item8 = Ext.create('Ext.Panel', {
                title: 'Calendar Events',
                
                 items: [{
                    // Use the default, automatic layout to distribute the controls evenly
                    // across a single row
                    xtype: 'checkboxgroup',
                    cls: 'x-check-group-alt',
                    width: 688,
                    height: 108,
                    style: 'margin-top:-20px;',
                    columns: 1,
                    items:[{
            // Use the default, automatic layout to distribute the controls evenly
            // across a single row
            xtype: 'checkboxgroup',
            cls: 'x-check-group-alt',
			fieldLabel: 'Show Events',
                        width: 688,
                        
            
			columns: 4,
            items: [
				{boxLabel: 'Corporate Events', name: 'cb-horiz-9',id:'Corporate_Events',listeners: {change: Corporate_Events}},
				{boxLabel: 'Board Meetings', name: 'cb-horiz-10',id:'Board_Meetings',listeners: {change: Board_Meetings}}

            ]
        },{
            // Use the default, automatic layout to distribute the controls evenly
            // across a single row
            xtype: 'checkboxgroup',
            cls: 'x-check-group-alt',
            width: 688,
            
			columns: 1,
            items: [
				{boxLabel: 'Delete All Events', name: 'cb-horiz-9',id:'Delete_All_Events',listeners: {change: Delete_All_Events}},
				
            ]
        }]}],
                cls:'empty'
            });
            
            
            var btn=Ext.create('Ext.Button', {
                text: 'Click me',
                //cls:'empty',
                handler: function() {
                alert('You clicked the button!');
                }
            });
            var accordion = Ext.create('Ext.Panel', {
                title: 'Settings',
                collapsible: false,
                //region:'centere',
                margins:'5 5 5 5',
                split:true,
                
            buttons: [
                { text: 'Reset',
                handler: function(){
                Ext.getCmp("path").setValue("");
                Ext.getCmp("amibroker").setValue(false);
                Ext.getCmp("advancedget").setValue(false);
                Ext.getCmp("fchart").setValue(false);
                Ext.getCmp("metastock").setValue(false);
                Ext.getCmp("ninja").setValue(false);
                
                Ext.getCmp("Bse_Index").setValue(false);
                Ext.getCmp("Bse_Cash_Market").setValue(false);
                Ext.getCmp("Ncdex_Futures").setValue(false);
                
                Ext.getCmp("Nse_Equity_Futures").setValue(false);
                Ext.getCmp("Nse_Equity_Options").setValue(false);
                Ext.getCmp("Nse_Forex_Futures").setValue(false);
                Ext.getCmp("Nse_Forex_Options").setValue(false);
                Ext.getCmp("Nse_Sme").setValue(false);
                Ext.getCmp("Nse_Etf").setValue(false);
                Ext.getCmp("Nse_Index").setValue(false);
                Ext.getCmp("Nse_reports").setValue(false);
                Ext.getCmp("Nse_Combined_reports").setValue(false);
                
                Ext.getCmp("MCX_Index").setValue(false);
                Ext.getCmp("MCX_Commodity_Futures").setValue(false);
                Ext.getCmp("National_Spot_Exchange").setValue(false);
                
                Ext.getCmp("Yahoo_Fundamental").setValue(false);
                Ext.getCmp("Yahoo_EOD").setValue(false);
                Ext.getCmp("Yahoo_IEOD_5min").setValue(false);
                Ext.getCmp("Yahoo_IEOD_1min").setValue(false);
                Ext.getCmp("Yahoo_Realtime").setValue(false);
                Ext.getCmp("yahoohr").setValue("5");
                Ext.getCmp("yahoomin").setValue("30");
                
                Ext.getCmp("Google_EOD").setValue("30");
                Ext.getCmp("Google_1min_IEOD").setValue("30");
                Ext.getCmp("Google_5min_IEOD").setValue("30");
                Ext.getCmp("google").setValue("1");
                Ext.getCmp("googlehr").setValue("0");
                Ext.getCmp("googlemin").setValue("0");
                
                Ext.getCmp("Corporate_Events").setValue("0");
                Ext.getCmp("Board_Meetings").setValue("0");
                Ext.getCmp("Delete_All_Events").setValue("0");
                
                }
            },{ text: 'Save',
                handler: function(){
                						var fs = require('fs');
            path=$("#path-inputEl").val();
			var drivePath = path.split('/')[0]+'/';
			
			  
			if(path!='')
			{
				if(fs.existsSync(drivePath.replace(/\s+/g, '')))
				{
					
					function savesetting(path)
                                        {
										 
										
                                    if(deleteallevents)
                                        event='Delete_All_Events-'+event;
										 if(corporateevents)
                                        event='Corporate_Events-'+event;
										if(boardmeetings)
                                        event='Board_Meetings-'+event;
										
										if(advancedget)
                                        format='Advanced_Get-'+format;
										if(ninja)
                                        format='Ninja-'+format;
                                    
										if(amibroker)
                                        format='AmiBroker-'+format;
										if(metastock)
                                        format='MetaStock-'+format;
										if(fchart)
                                        format='FChart-'+format;
										
										if(nsein)
                                        options='Nse_Index-'+options;
                                        if(bsein)
                                        options='Bse_Index-'+options;
                                        if(bsecm)
                                        options='Bse_Cash_Market-'+options;
										if(nseef)
                                        options='Nse_Equity_Futures-'+options;
                                        if(nseeo)
                                        options='Nse_Equity_Options-'+options;
                                        if(nseff)
                                        options='Nse_Forex_Futures-'+options;
                                        if(nsefo)
                                        options='Nse_Forex_Options-'+options;
                                        if(nsesme)
                                        options='Nse_Sme-'+options;
                                        if(nseetf)
                                        options='Nse_Etf-'+options;
                                        
                                        if(ncdex)
                                        options='Ncdex_Futures-'+options;
                                        if(yahoof)
                                        options='Yahoo_Fundamental-'+options;
                                        if(mcxcf)
                                        options='MCX_Commodity_Futures-'+options;
                                        if(mcxin)
                                        options='MCX_Index-'+options;
                                        if(nseex)
                                        options='National_Spot_Exchange-'+options;
                                        if(nserpt)
                                        options='Nse_reports-'+options;
                                        if(nsecmbndrpt)
                                        options='Nse_Combined_reports-'+options;
                                        if(yahooe)
                                        options='Yahoo_EOD-'+options;
                                        if(yahoo5)
                                        options='Yahoo_IEOD_5min-'+options;
                                        if(yahoo1)
                                        options='Yahoo_IEOD_1min-'+options;
                                        if(googlee)
                                        options='Google_EOD-'+options;
                                        if(google1m)
                                        options='Google_1min_IEOD-'+options;
                                        if(google5m)
                                        options='Google_5min_IEOD-'+options;
                                        if(yahooreal)
                                        options='Yahoo_Realtime-'+options;
										
										/*
                                        days=$("#google-inputEl").val();
                                        */
                                        var  gd = Ext.getCmp('google');
										var googledays = gd.getValue();
										
										var  yhr = Ext.getCmp('yahoohr');
										var yahoohr = yhr.getValue();
										var  ymin = Ext.getCmp('yahoomin');
										var yahoomin = ymin.getValue();
										
										var  ghr = Ext.getCmp('googlehr');
										var googlehr = ghr.getValue();
										var  gmin = Ext.getCmp('googlemin');
										var googlemin = gmin.getValue();
                                                                                fs.writeFile('settings_flag.txt','saved',function(err){
                                                                                    if(err)console.log(err.stack);
                                                                                });
                              
										savesettings(path,options,googledays,format,event,yahoohr,yahoomin,googlehr,googlemin);
                                    }
					
					
					fs.mkdir(path, 0777, function(err)
					{
						if(err)
						{
							//var fs = require('fs');
							if(fs.existsSync(path))
							{
								savesetting(path);
                                                                
                                                                if(nsecmbndrpt)
                                                                {
                                                                    Ext.Msg.alert('Message', '<font color="green">Settings are saved successfully.</font><br/><br/><small><b>Note:-</b>Combined Report may  take few minutes to download.</small>', function(){
									// process text value...
									//location.reload();
								});
                                                                }
                                                                else
								Ext.Msg.alert('Message', '<font color="green">Settings are saved successfully.</font>', function(){
									// process text value...
									//location.reload();
								});
							}
							else
							{
								Ext.Msg.alert('Message', '<font color="red">Cannot create directory. Please check output folder path.</font>');
							}
						}
						else
						{
							savesetting(path);
							if(nsecmbndrpt)
                                                                {
                                                                            Ext.Msg.alert('Message', '<font color="green">Settings are saved successfully.</font><br/><br/><small><b>Note:-</b>Combined Report may  take few minutes to download.</small>', function(){
									// process text value...
									//location.reload();
								});
                                                                }
                                                                else
                                                        Ext.Msg.alert('Message', '"'+path+'" <font color="green">directory created successfully and settings are saved successfully.</font>', function(){
                                                        
								// process text value...
					     		//location.reload();
							});
						}
							
					});
					
					
					options='';googledays='';format='';event='';yahoohr='';yahoomin='';googlehr='';googlemin='';
					
				}else
				{
					Ext.Msg.alert('Message', '"'+drivePath.replace(/\s+/g, '')+'" <font color="red">Drive not present. Please check path.</font>');
					
				}
			}
				else
				{
						//Ext.Msg.alert('Message','Please select output folder path.');
						var w = Ext.Msg.alert({
								title: 'Message',
								msg: '<font color="red">Please select output folder path.</font>',
								buttons: Ext.Msg.OK,
								autoShow: false,
								cls: 'msgbox'    
						});
						options='';googledays='';format='';event='';yahoohr='';yahoomin='';googlehr='';googlemin='';
				}
			   
			   
			   
				
			   
                }
            }]
            ,
                height: 360,
                width: 690,
                layout:'accordion',
                items: [item2, item3, item4, item5, item6, item7, item8]
            });

            var viewport = Ext.create('Ext.Viewport', {
                
                items:[
                    accordion]
            });
            
            
            
            
            
            
            var win;
    if(!win){
        win = new Ext.Window({
            applyTo     : 'hello-win',
            layout      : 'fit',
			title:'Note:',
            width       : 500,
			border: 0,
			id: 'tt',
			closable: false,
            height      : 100,
            closeAction :'hide',
			html: '<div id="ttmsg"><ul><li>1. Output folder path Example: C:/data </li><li>2. Application will download & process data from web in this folder and generate &nbsp;&nbsp;&nbsp;&nbsp;output data.</li><li>3. Please make sure you have 4GB free on this drive.</li></ul></div>',
            plain       : true
            
        });
      
		/*var reload = function() {                 
              win.close();
            }
            setInterval(reload , 1000);*/
    } 
  
  
Ext.getCmp('path').getEl().on('mouseover', function()
{
     win.show();
}
);

Ext.getCmp('path').getEl().on('click', function()
{
     win.close();
}
);

Ext.getCmp('path').getEl().on('mouseout', function()
{
     win.close();
}
);
            
          
          
var cb = Ext.getCmp('Nse_Cash_Market');
	cb.disable();
	var cb1 = Ext.getCmp('BSE_Equity_Futures');
	cb1.disable();
        var cb11 = Ext.getCmp('BSE_Equity_Options');
	cb11.disable();
	var cb2 = Ext.getCmp('MCX_SX_Forex_Futures');
	cb2.disable();
	var cb3 = Ext.getCmp('MCX_SX_Forex_Options');
	cb3.disable();
	var cb4 = Ext.getCmp('MCX_SX_Equity_Indices');
	cb4.disable();
	var cb5 = Ext.getCmp('MCX_SX_Equity_Futures');
	cb5.disable();
	var cb6 = Ext.getCmp('MCX_SX_Equity_Options');
	cb6.disable();
	var cb7 = Ext.getCmp('Mutual_Funds_NAV');
	cb7.disable();	
	var cb8 = Ext.getCmp('stdcsv');
	cb8.disable();
		
getsettings();          
          
function Delete_All_Events(field) 
{
	deleteallevents=field.getValue();
	
	if(deleteallevents)
	{
		var chkbm = Ext.getCmp('Board_Meetings');
		chkbm.setValue(false);
		chkbm.disable();
		
		var chkcm = Ext.getCmp('Corporate_Events');
		chkcm.setValue(false);
		chkcm.disable();
	}
	else
    {
		var chkbm = Ext.getCmp('Board_Meetings');
		chkbm.enable();
		
		var chkcm = Ext.getCmp('Corporate_Events');
		chkcm.enable();
    }
}

function Board_Meetings(field) 
{
  boardmeetings=field.getValue();
}

function Corporate_Events(field)
{
  corporateevents=field.getValue();
}
function STD_CSV(field)
{
  stdcsv=field.getValue();
}
function Advanced_Get(field)
{
  advancedget=field.getValue();
}
function Ninja(field)
{
  ninja=field.getValue();
}
function AmiBroker(field)
{
  amibroker=field.getValue();
  
}
function MetaStock(field)
{
  metastock=field.getValue();
}
function FChart(field)
{
  fchart=field.getValue();
}	
function Yahoo_Realtime(field)
{
  yahooreal=field.getValue();
}
function Google_EOD(field)
{
  googlee=field.getValue();
}
function Google_1min_IEOD(field)
{
  google1m=field.getValue();
}
function Google_5min_IEOD(field)
{
  google5m=field.getValue();
}
function Yahoo_IEOD_1min(field)
{
  yahoo1=field.getValue();

}
function Yahoo_IEOD_5min(field)
{
  yahoo5=field.getValue();

}
function Yahoo_EOD(field)
{
  yahooe=field.getValue();

}
function Nse_Cash_Market(field)
{
  nsecm=field.getValue();

}
function Nse_Equity_Futures(field)
{
  nseef=field.getValue();

}
function Nse_Equity_Options(field)
{
  nseeo=field.getValue();

}
function Nse_Forex_Futures(field)
{
  nseff=field.getValue();

}
function Nse_Forex_Options(field)
{
  nsefo=field.getValue();

}

function Nse_Sme(field)
{
  nsesme=field.getValue();

}
function Nse_Etf(field)
{
  nseetf=field.getValue();

}

function Nse_Index(field)
{
  nsein=field.getValue();

}


function Bse_Index(field)
{
  bsein=field.getValue();

}
function Bse_Cash_Market(field)
{
  bsecm=field.getValue();

}
function Ncdex_Futures(field)
{
  ncdex=field.getValue();

}

function Yahoo_Fundamental(field)
{
  yahoof=field.getValue();

}

function MCX_Commodity_Futures(field)
{
  mcxcf=field.getValue();

}
function MCX_Index(field)
{
  mcxin=field.getValue();

}
function National_Spot_Exchange(field)
{
  nseex=field.getValue();

}
function Nse_reports(field)
{
  nserpt=field.getValue();

}
function Nse_Combined_reports(field)
{
  nsecmbndrpt=field.getValue();
  

}

        });
        
    </script>
</head>
<body>
<script type="text/javascript" src="shared/examples.js"></script><!-- EXAMPLES -->

</body>
</html>
